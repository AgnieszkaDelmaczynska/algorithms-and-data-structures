INPUT 1
I 2
A 4
A 3
A 5
? 1
? 3
? 4
? 5
A 1
? 1 
? 2 
? 3
? 4
? 5
X

OUTPUT 1
1 -
3 +
4 +
5 +
1 +
2 -
3 +
4 +
5 +

INPUT 2
I 2
A 5
A 3
A 2
A 8
A 10
A 4
A 6
A 7
A 9
? 1
? 2
? 3
? 3
? 12
? 4
? 4
? 66
? 1
? 1
? 2
X

OUTPUT 2
1 -
2 +
3 +
3 +
12 -
4 +
4 +
66 -
1 -
1 -
2 +

INPUT 3
I 4
A 2
A 3
A 4
A 5
A 6
A 7
A 8
A 9
A 10
A 11
A 12
A 13
A 14
A 15
A 16
A 20
A 17
A 18
A 19
A 21
A 23
A 24
A 30
A 29
A 28
A 27
A 26
A 25
? 1
? 22
? 10
? 8
? 9
? 30
? 1
? 1
? 20
X

OUTPUT 3
1 -
22 -
10 +
8 +
9 +
30 +
1 -
1 -
20 +

INPUT 4
I 4
A 2
A 3
A 4
A 5
A 6
A 7
A 8
A 9
? 14
? 2
? 3
? 2
A 14
A 15
A 16
A 20
A 17
A 18
A 19
? 23
? 17
? 17
? 14
? 20
A 21
A 23
A 10
A 11
A 12
A 13
A 28
A 27
A 26
A 25
? 1
? 22
? 10
? 8
? 9
? 30
? 1
? 1
? 20
A 24
A 30
A 29
? 29
X

OUTPUT 4
14 -
2 +
3 +
2 +
23 -
17 +
17 +
14 +
20 +
1 -
22 -
10 +
8 +
9 +
30 -
1 -
1 -
20 +
29 +

INPUT 6
I 3
A 3
A 4
A 5
A 2
A 6
A 7
A 11
A 12
A 13
A 14
A 8
A 9
P
A 1
A 10
P
X

OUTPUT 6
2 3 4 5 6 7 8 9 11 12 13 14 
1 2 3 4 5 6 7 8 9 10 11 12 13 14 

INPUT 8
L 2
( 4 )
? 4
? 1
? 4
X

OUTPUT 8
4 +
1 -
4 +

INPUT 9
L 2
( 1 4 6 )
? 1 
? 3
? 1
? 4
? 10
X

OUTPUT 9
1 +
3 -
1 +
4 +
10 -

INPUT 10
L 4
( ( 2 3 4 ) 5 ( 6 7 ) 9 ( 10 11 12 ) 13 ( 14 15 ) 17 ( 18 19 20 ) 21 ( 23 24 25 26 ) 27 ( 28 29 30 ) )
? 1
? 31
? 32
? 5
? 22
? 10
A 1
A 31 
A 32
? 1 
? 31
? 32
? 8
? 666
? 16
? 22
A 8 
A 16
A 22
? 8
? 16
? 22
X

OUTPUT 10
1 -
31 -
32 -
5 +
22 -
10 +
1 +
31 +
32 +
8 -
666 -
16 -
22 -
8 +
16 +
22 +

INPUT 12
L 4
( ( 2 3 4 ) 5 ( 6 7 ) 9 ( 10 11 12 ) 13 ( 14 15 ) 17 ( 18 19 20 ) 21 ( 23 24 25 26 ) 27 ( 28 29 30 ) )
S
X

OUTPUT 12
4
( ( 2 3 4 ) 5 ( 6 7 ) 9 ( 10 11 12 ) 13 ( 14 15 ) 17 ( 18 19 20 ) 21 ( 23 24 25 26 ) 27 ( 28 29 30 ) )